<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>POLYMAP3|Atlas</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="keywords" content="Geoportal, Karte, GIS, Polymap, Atlas, GDI, Ort, Geodaten, Geodatenkatalog, POI">
<meta name="description" content="Atlas">
<meta name="robots" content="index,follow">
<meta name="revisit-after" content="10 days">
<!-- meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0"-->
<meta http-equiv="cache-control" content="max-age=3600, must-revalidate">
<meta name="resource-type" content="document">
<meta name="Audience" content="Alle">
<meta name="rating" content="general">
<meta name="objecttype" content="journal">
<meta name="distribution" content="global">
<link rel="shortcut icon" href="images/favicon.ico">

<!-- jQuery -->
<script language="javascript" src="lib/jquery-1.7.1.min.js" type="text/javascript"></script>
<script language="javascript" src="lib/urlEncode.js" type="text/javascript"></script>
<script language="javascript" src="lib/jFav_v1.0.js" type="text/javascript"></script>
<script language="javascript" src="lib/jquery.getUrlParam.js" type="text/javascript"></script>
<script language="javascript" src="lib/jquery-ui-1.8.18.custom.min.js" type="text/javascript"></script>
<script language="javascript" src="lib/jquery.dd.js" type="text/javascript"></script>
<script language="javascript" src="lib/jquery.layout-1.3.0.js" type="text/javascript"></script>
<script language="javascript" src="lib/jquery.localizer.js" type="text/javascript"></script>
<script language="javascript" src="lib/jquery.i18n.properties-1.0.9.js" type="text/javascript"></script>
<script language="javascript" src="lib/jquery.scrollTo-1.4.2-min.js" type="text/javascript"></script>

<!-- OpenLayers -->
<!--script src="openlayers/full/OpenLayers.js" type="text/javascript"></script-->
<script src="openlayers/2.11/OpenLayers.js" type="text/javascript"></script>
<script src="openlayers/full/popup.js" type="text/javascript"></script>
<!--script src="openlayers/full/tooltips.js" type="text/javascript"></script-->

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="css/custom-theme/jquery-ui-1.8.16.custom.css" />
<!--link rel="stylesheet" type="text/css" href="css/redmond/jquery-ui-1.8.custom.css" /-->
<!--link rel="stylesheet" type="text/css" href="css/ui-lightness2/jquery-ui-1.8.custom.css" /-->
<!-- link rel="stylesheet" type="text/css" href="css/cupertino2/jquery-ui-1.8.custom.css" /-->
<!--link rel="stylesheet" type="text/css" href="css/pepper-grinder/jquery-ui-1.8.custom.css" /-->
<!-- link rel="stylesheet" type="text/css" href="css/dd.css" /-->
<link rel="stylesheet" type="text/css" href="css/atlas.layout.css" />
<!--link rel="stylesheet" type="text/css" href="lib/jquery.expandable.css" /-->

<!-- Atlas JavaScript -->
<script src="js/utils.js" type="text/javascript"></script>
<script src="js/atlas.layout.js" type="text/javascript"></script>
<script src="js/inheritance.js" type="text/javascript"></script>
<script src="js/events.js" type="text/javascript"></script>
<script src="js/atlas.js" type="text/javascript"></script>
<script src="js/toolitems.js" type="text/javascript"></script>
<script src="js/topbar.js" type="text/javascript"></script>
<script src="js/transmap.js" type="text/javascript"></script>
<script src="js/measure.js" type="text/javascript"></script>
<script src="js/searchservice.js" type="text/javascript"></script>
<script src="js/searchlayer.js" type="text/javascript"></script>
<script src="js/searchcontext.js" type="text/javascript"></script>
<script src="js/searchpriority.js" type="text/javascript"></script>
<script src="js/routing.service.js" type="text/javascript"></script>
<script src="js/routing.nearby.js" type="text/javascript"></script>
<script src="js/routing.shortestpath.js" type="text/javascript"></script>
<script src="js/routing.js" type="text/javascript"></script>
<script src="js/boundsearch.js" type="text/javascript"></script>

<!-- Local config -->
<script type="text/javascript">

// the Atlas environment
MyAtlasClass = AtlasClass.extend( new function() {
    this.init = function( config ) {
        Atlas = this;
        this._super( {
            //autocompleteUrl : '../polymap/lka/search',
            autocompleteUrl: 'search',
            searchUrl: 'search',
            baseUrl: 'index.html',
            mapCRS: "EPSG:900913"
        });
        
        // init search result priorities        
        this.priorities.push( new ExclusiveCategoriesPriority( ['buchung', 'address'] ) );
        this.priorities.push( new OnScreenPriority() );
        this.priorities.push( new LexicalPriority() );
        
        // load and init bound search
        $.ajax({
            url: 'boundsearch.json',
            dataType: 'html',
            cache: false,
            success: function( data ) {
                var json = new OpenLayers.Format.JSON().read( data );
                Atlas.boundSearch = new BoundSearch( json );
            }
        });
        
        // init measure
        Atlas.measure = new MeasureMode( Atlas.map, $("#measure_link") );
        
        // init I18N
        var lang = $(document).getUrlParam( "lang" );    
        jQuery.i18n.properties({
                name: 'messages', 
                path: 'bundle/', 
                mode: 'map', 
                language: lang,  //'cz_CZ',
                callback: function( settings ) {
                    Atlas.language = settings.language;
                }
        });
    
        // init translation; tweak context functions
        Atlas.transmap = new TransMap( 'bundle/trans_', ['de_cz'] );
        
        Atlas.routing = new Routing(
            '../routing-service/web/v1.0', 
            'a27fb9d8ace734e3b4395ec342ddb35c' );
            //'f4c8d0c39ff58a705a9677f38fbee7af' );
        
        // Topbar
        Atlas.topbar = new Topbar( $('#topbar') )
            .addLeft( new LinkToolItem( "tb_1", $.i18n.prop( "project_title" ), 
                    "tooltip", $.i18n.prop( "project_link" ) ) )
            //.addLeft( new LinkToolItem( "tb_2", "Projekt", "tooltip", "http://google.de" ) )
            //.addRight( new LangSwitcherItem( "tb_cz", "images/cz.gif", "", "cz" ) )
            //.addRight( new LangSwitcherItem( "tb_de", "images/de.gif", "", "de" ) )
            //.addRight( new LangSwitcherItem( "tb_en", "images/en.gif", "", "en" ) )
            .addRight( new HtmlDialogToolItem( "tb_help", "tb_help".i18n(), "tb_help_tip".i18n(), $('#dialog'), "hilfe.html" ) )
            .addRight( new HtmlDialogToolItem( "tb_legal", "tb_legal".i18n(), "tb_editorial_tip".i18n(), $('#dialog'), "impressum.html" ) )
            .addRight( new HtmlDialogToolItem( "tb_contact", "tb_contact".i18n(), "tb_contact_tip".i18n(), $('#dialog'), "kontakt.html" ) )
            .create();
        
        // Toolbar
        Atlas.toolbar = new Toolbar( $('#toolbar2') )
            .addLeft( new ToggleLayerItem( "tb_dop", $.i18n.prop( "tb_dop_label" ), 
                    $.i18n.prop( "tb_dop_label" ), $.i18n.prop( "tb_dop_icon" ), Atlas.map, "DOP" ) )
            .addRight( new SubmitNewItem( "tb_new" ) )
            .addRight( new ToggleMeasureItem( "tb_measure", Atlas.measure ) )
            .addRight( new LinkItem( "tb_link" ) )
            .addRight( new KmlItem( "tb_kml" ) )
            .addRight( new GeoRssItem( "tb_georss" ) )
            .addRight( new BookmarkItem( "tb_bookmark" ) )
            //.addRight( new TestRoutingItem( "tb_routing", Atlas.routing ) )
            .create();
        
        dialogDiv = $('#dialog');        
    
        // localize HTML
        $(function() {
            $('html').localize();
        });
    
        // make all divs in north_pane visible after the HTML is localized
        window.setTimeout( function() {
            $('#north_pane>div').fadeIn( 1000 );
            $('#search_field').focus();
        }, 1000 );
    };
});

var Atlas;

function initLocal() {
    // init the Atlas
    Atlas = new MyAtlasClass();
}

/**
 * The page URL including search params from all search contexts.
 */
function pageUrl() {
    var searchStr = Atlas.contexts[Atlas.result_index].searchStr;
    
    // ?search=XY&search2=AB
    var allSearchParams = null;
    for (i=0; i<Atlas.contexts.length; i++) {
        var context = Atlas.contexts[i];
        if (context.searchStr != null && context.searchStr.length > 0) {
            allSearchParams = allSearchParams == null 
                    ? "?" : allSearchParams + "&";
            allSearchParams += "search" + (i+1) + "=" + context.searchStr;
        }
    }    
    return location.protocol + "//" 
            + location.host + location.pathname + allSearchParams;
};

</script>
</head>

<!-- ******************************************************
  - HTML
  -->
<body onload="initLocal(); init_layout(); ">        

<!-- Layout North -->
<!--div class="ui-layout-north" onmouseover="myLayout.allowOverflow('north')" onmouseout="myLayout.resetOverflow(this)"-->
<div id="north_pane" class="ui-layout-north" style="padding:0px; overflow:visible; overflow-x:auto; overflow-y:hidden;">
    <!-- Topbar -->
    <div id="topbar" style="display:none;">
    </div>

    <!-- Logo -->
    <div id="logo_pane" style="display:none;">
        <a title="logo_title" href="logo_link"> 
        <img style= border:none; src="logo_img" id="logo" alt="logo_img_alt" width="200" height="74"/></a>
    </div>
    
    <!-- Search Form -->
    <div id="search_pane" class="ui-widget-content" style="border:none; display:none;">
        <img style="margin: 1px 0px 0px; padding: 0px; position: absolute; left: -38px; top: 20px;" src="images/marker_red.png" id="search_img">
        
        <input title="Sucheingabe" id="search_field" size="40" maxlength="150" 
            class="ui-autocomplete-input ui-widget" />
        
        <button id="search_btn" value="Suchen" title="Suchen"></button>
    </div>
</div>

<!-- Layout East -->
<div id="tabs" class="ui-layout-east" style="visibility:hidden;">
    <!--div id="tabs" style="height: 100%;"-->
        <ul style="border-top:none; border-right:none; border-left:none;">
            <li>
                <a href="#result_body0" id="tab_title_result0"
                   style="border:none; width:28px; color:#ffffff; text-shadow: 1px 1px 2px #666; padding:0.4em 0.5em 0.4em 1.5em; background:url(images/marker_red.png) no-repeat scroll 5px 50% transparent;">
                    <!--img src="images/marker_red.png" width="24" height="14" style="border: none;" /-->
                    &lt;&gt;
                </a>
            </li>
            <li>
                <a href="#result_body1" id="tab_title_result1"
                   style="border:none; width:28px; color:#ffffff; text-shadow: 1px 1px 2px #666; padding:0.4em 0.5em 0.4em 1.5em; background:url(images/marker_green.png) no-repeat scroll 5px 50% transparent;">
                    <!--img src="images/marker_red.png" width="24" height="14" style="border: none;" /-->
                    &lt;&gt;
                </a>
            </li>
            <li>
                <a href="#result_body2" id="tab_title_result2"
                   style="border:none; width:28px; color:#ffffff; text-shadow: 1px 1px 2px #666; padding:0.4em 0.5em 0.4em 1.5em; background:url(images/marker_yellow.png) no-repeat scroll 5px 50% transparent;">
                    <!--img src="images/marker_red.png" width="24" height="14" style="border: none;" /-->
                    &lt;&gt;
                </a>
            </li>
            <li>
                <a href="#result_body3" id="tab_title_result3"
                   style="border:none; width:28px; color:#ffffff; text-shadow: 1px 1px 2px #666; padding:0.4em 0.5em 0.4em 1.5em; background:url(images/marker_blue.png) no-repeat scroll 5px 50% transparent;">
                    <!--img src="images/marker_red.png" width="24" height="14" style="border: none;" /-->
                    &lt;&gt;
                </a>
            </li>
            <!--li><a href="#result_body1">
                <img src="images/marker_green.png" width="24" height="14" style="border: none;" />
            </a></li-->
        </ul>
        
        <div id="result_body0" class="atlas-result-body ui-layout-content ui-dialog-content">
            <div class="atlas-result">result_body_red</div>
        </div>
        <div id="result_body1" class="atlas-result-body ui-layout-content ui-dialog-content">
            <div class="atlas-result">result_body_green</div>
        </div>
        <div id="result_body2" class="atlas-result-body ui-layout-content ui-dialog-content">
            <div class="atlas-result">result_body_yellow</div>
        </div>
        <div id="result_body3" class="atlas-result-body ui-layout-content ui-dialog-content">
            <div class="atlas-result">result_body_blue</div>
        </div>
</div>

<!-- Layout Center -->
<!-- overflow-xxx is for IE to hide vertical scrollbar -->
<div id="center_pane" class="ui-layout-center" style="visibility:hidden; padding:0px; overflow:visible; overflow-x:auto; overflow-y:hidden; border:none;">
    
    <div id="toolbar2" style="z-index:100;"></div>

    <!-- div class="map-shadow ui-widget-content ui-corner-bottom"
            style="z-index: 1000; background-color: transparent; position: absolute; left: 0px; right: 0px; top: 34px; bottom: 0px;">
    </div-->
    <div id="map" class="ui-widget-content ui-corner-bottom"
            style="position: absolute; left: 0px; right: 0px; top: 34px; bottom: 0px; background: #ECEDF5;">
    </div>
</div>

<!-- This div is used as the content of the dialog boxes for help, contact, etc. -->
<div id="dialog"></div>

</body>
</html>
